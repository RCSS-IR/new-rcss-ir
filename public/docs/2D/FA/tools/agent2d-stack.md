# Agent2DStack

ابزار [Agent2DStack](https://github.com/KN2C2D/agent2d-stack) ابزاریست ساده برای کار با تیم پایه‌ی Agent2D. در این ابزار کتابخانه Librcsc و تیم پایه Agent2D به همراه ابزار‌ها و اسکریپت‌های کاربردی دیگر در کنار هم قرار گرفته‌اند.

با استفاده از این ابزار شما از این مزایا برخوردار می‌شوید :

- نصب نسخه‌های مختلفی از لیب بر روی سیستم که به هم دیگر آسیبی نمیزنند.
- اسکریپت‌های Make و ساختن باینری 
- ابزار یکپارچه‌سازی مداوم و تحویل پیوسته (CI/CD)

## Build بار اول

1. نیازمندی‌ها را با دستور زیر نصب کنید.

```bash
sudo apt-get update && sudo apt-get install -y g++ build-essential libboost-all-dev qt4-dev-tools libaudio-dev libgtk-3-dev libxt-dev bison flex
```

2. ابزار را در سیستم خود Clone کنید.

```bash
git clone https://github.com/KN2C2D/agent2d-stack.git && cd agent2d-stack
```

3. حال با دستور زیر تیم پایه و کتابخانه آن Build می‌شوند.

```bash
./makeFirstTime.sh
```

   با استفاده از این اسکریپت، کتابخانه Librcsc به صورت محلی(local) در پوشه `Agent/Lib` نصب می‌شود و Agent نیز با استفاده از همان کتابخانه محلی Build می‌شود.

## Build بعد از تغییرات

بعد از تغییر دادن فایل‌های Agent شما میتوایند با استفاده از اسکریپت `makeAgent.sh` تنها Agent را Build کنید. درصورتی که فایل‌های Lib را نیز تغییر داده بودید میتوانید از اسکریپت `makeAll.sh` استفاده کنید.

## ساخت باینری استاتیک

باینری استایتک، به فایل اجرایی از کد تیم شما گفته می‌شود که کمترین نیازمندی‌ای به محیط اجرا داشته باشد و بتوان آن را به تنهایی در سیستم لینوکسی دیگری اجرا کرد. برای شرکت در مسابقات اسکریپت‌های اجرایی خاصی (`start` و `startall` و `kill`)  نیاز است که به این باینری اضافه شود. با اجرای اسکریپت `makeBin.sh` شما میتوانید به راحتی فایل اجرایی استاندارد را برای شرکت در مسابقات شبیه‌سازی دوبعدی فوتبال بسازید. این فایل در این آدرس `Bin/Binary.tar.gz` ذخیره می‌شود. 

## یکپارچه‌سازی مداوم و تحویل پیوسته (CI/CD)

مبحث یکپارچه‌سازی مداوم و تحویل پیوسته یکی از تازه‌ترین مباحث مهندسی نرم افزار است که اکنون اهمیت بسیاری در فرایند ساخت نرم‌افزار دارد. در ویکیپدیا تعریف [یکپارچه‌سازی مداوم](https://fa.wikipedia.org/wiki/%DB%8C%DA%A9%D9%BE%D8%A7%D8%B1%DA%86%D9%87%E2%80%8C%D8%B3%D8%A7%D8%B2%DB%8C_%D9%85%D8%AF%D8%A7%D9%88%D9%85)([CI](https://en.wikipedia.org/wiki/Continuous_integration)) به اینگونه ‌آمده است:

> **یکپارچه‌سازی مداوم** و یا **ادغام مداوم** (CI) در برنامه‌نویسی به مجموعه‌ای از روش‌ها می‌گویند که باعث حفظ انسجام کد  می‌شود و از به‌هم‌ریختگی کد جلوگیری می‌کند. این روش‌ها مبتنی بر build  کردن مداوم پروژه پس از هر تغییر در کد توسط برنامه‌نویسان و اجرای [تست کیس‌های](https://fa.wikipedia.org/wiki/تست_کیس) برنامه است. به عنوان مثال هر زمان که یک commit توسط توسعه‌دهنده بر روی  مخزن پروژه push شود همهٔ تست‌ها اجرا می‌شود تا بتوان اطمینان حاصل نمود  که همهٔ قسمت‌های پیشین کد و قسمت‌های تازه نوشته‌شده با یک‌دیگر سازگاری  دارد و درست کار می‌کند. 

در محیط شبیه‌سازی دوبعدی اغلب تیم‌ها با حجم بالایی از کد سروکار دارند. زمانیکه شما میخواهید تغییرات جدید را به کد اعمال کنید ممکن است تغییرات شما باعث بروز مشکل در بخش دیگری از کد بشود. به طور مثال Kill شدن بازیکن در زمان اجرای بازی. تست کردن تمامی موارد بعد از اضافه شدن کد به مخزن ممکن است وقت‌گیر باشد به همین دلیل باید از ابزار‌های خودکار **یکپارچه‌سازی مداوم** یا **CI** استفاده کرد. شما میتوانید با fork کردن این پروژه در صفحه‌ی شخصی خود از این تست‌ها به صورت خودکار بعد از هر تغییر استفاده کنید. در **Agent2DStack** به طور پیشرفض تست‌های زیر در ابزار‌های Gitlab CI/CD و Github Actions و Circle-CI پیاده شده است. 

1. **تست بیلد شدن پروژه** { Gitlab CI/CD و Github Actions و Circle-CI}
2. تست اجرای بازی (برسی کیل شدن کد) {بزودی}
3. بزودی ...

[تعریف تحویل پیوسته](https://fa.wikipedia.org/wiki/%D8%AA%D8%AD%D9%88%DB%8C%D9%84_%D9%BE%DB%8C%D9%88%D8%B3%D8%AA%D9%87) ([CD](https://en.wikipedia.org/wiki/Continuous_delivery)) در ویکیپدیا اینگونه آمده است:

> Continuous Delivery یا (CD)، رویکردی در مهندسی نرم‌افزار است که تیم‌ها  را قادر می‌سازد نرم‌افزار تولید شده را به روشی سریع و مطمئن برای انتشار و تحویل آماده کنند. این فرایند از لحظه اضافه شدن یا تغییر کد در source  control شروع می‌شود و شامل بیلد، تست، پیکربندی و انتشار در محیط‌های  مختلف تست و محیط عملیات می‌شود. این مفهوم در فارسی به «تحویل مداوم» یا  «تحویل مستمر» ترجمه شده‌است. 

در محیط شبیه‌سازی دوبعدی اغلب تیم‌ها بعد از تغییرات فراوان بر کد نیاز به وجود فایل اجرایی از هر نسخه از کد را حس میکنند چراکه فرایند ساخت باینری استایتک از نسخه‌های مختلف کد ممکن است زمانبر یا حتی پیچیده باشد. نگهداری این نسخه‌ها نیز نیازمند فضای ذخیره‌سازی زیادیست. شما میتوانید با fork کردن **Agent2DStack** در اکانت **Github** یا **Gitlab** خود همیشه باینری استایتک هر نسخه از کد را در آن سایت ذخیره کنید. باینری استایتک هر نسخه بعد از حدود ۵ الی ۱۰ دقیقه (بسته به پلتفورم استفاده شده) در بخش CI/CD قابل دانلود است. قابل ذکر است که این باینری را می‌توانید مستقیما در مسابقات استفاده کنید.

<ImageZoom 
  src="/docs/2D/FA/tools/img/gitlab-ci.jpg" 
  :border="true" 
  width="auto"
/>

> نتیجه یک Job در Gitlab

<ImageZoom 
  src="/docs/2D/FA/tools/img/github-ci.jpg" 
  :border="true" 
  width="auto"
/>

> نتیجه یک Job در Github

برای اطلاعات بیشتر راجب مبحث CI/CD میتوانید به [این پست](https://sokanacademy.com/blog/10005/%D8%B3%DB%8C-%D8%A2%DB%8C-%D8%B3%DB%8C-%D8%AF%DB%8C-%DA%86%DB%8C%D8%B3%D8%AA) مراجعه کنید.


<note type="tip" label="">
🔹 لطفا مشکلات خود را در 
<a href="https://github.com/KN2C2D/agent2d-stack">گیتهاب پروژه </a>
با ما در میان بگذارید.
</note>
