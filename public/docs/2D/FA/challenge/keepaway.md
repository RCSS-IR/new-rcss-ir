# رقابت Keepaway

![](/docs/2D/FA/challenge/img/keepaway.jpg)

[keepaway](https://en.wikipedia.org/wiki/Keep_away) (*خرس وسط*) یکی از رقابت‌های جذاب در شبیه‌سازی دوبعدی فوتبال است. در این رقابت سه بازیکن تیم چپ (تیم مدافع) قصد نگه داشتن توپ در یک زمین 20 متر در 20 متر را دارند و دو بازیکن تیم راست(تیم مهاجم) قصد بیرون انداختن توپ را دارند. این رقابت بر بستر شبیه‌سازی دوبعدی فوتبال و بیس ایجنت پیاده سازی شده است.

در سال 2016 و 2015 این رقابت در مسابقات ایران اپن برگزار شد که در آن سالها هر تیم به عنوان نگه دارنده با تیم دیگری در نقش مهاجم رقابت می‌نمود. در نهایت زمان نگهداری توپ به عنوان امتیاز تیم ثبت می‌شد. **در مسابقات ایران اپن 2020 بازی‌ها به صورت رفت و برگشتی انجام می‌شود** به صورتی که در بازی اول تیم A مدافع و تیم B مهاجم و در بازی دوم بلعکس آن انجام می‌شود در نهایت مجموع امتیازات برنده بازی را مشخص می‌کند. 

در این رقابت هر بازی شامل سه اپیزود زمانی 500 سایکلی(۵۰ ثانیه) است و هر تیم 3 اپیزود نقش مدافع را ایفا می نماید. امتیاز هر تیم در پایان دو بازی برابر با تعداد سایکل نگهداری از توپ در زمین 20 در 20 خواهد بود.

با توجه به توضیحات بالا هر تیم حداکثر 1500 امتیاز خواهند داشت. با توجه به تعداد تیم های شرکت کننده روش رقابت مشخص خواهد شد.
<note type="warning" label="">**توجه داشته‌باشید که در این رقابت تکل وجود دارد اما خطا وجود ندارد!**</note>

## نصب و اجرا

برای اجرای بازی در این رقابت نیاز به نصب سروری خاص است که بتواند در مود keepaway مقدار سیکلی که یک تیم توپ را نگهداری میکند را به عنوان امتیاز آن تیم ثبت کند. با این حال سرور رسمی مسابقات (rcssserver) نیز میتواند بازی را در این مود برای شما اجرا کند با این تفاوت که تعداد سیکلی که توپ دست شما بوده شمرده نمی‌شود! برای نصب سرور رسمی مسابقات به [اینجا](/2D/FA/basic/install) مراجعه کنید. برای اجرای رقابت keepaway شما میتوانید سرور را با دستور زیر اجرا کنید.

```bash
rcssserver server::keepaway=true server::foul_detect_probability=0.0 server::use_offside=false
```

یا میتوانید مقادیر متغیرهای بالا را در server.conf عوض کنید تا مقادیر ذخیره شوند.

```bash
cd ~/.rcssserver
gedit server.conf
```

برای اجرای کلاینت نیز شما میتوانید از تیم پایه [Agent2D-KeepAway](https://github.com/Cyrus2D/agent2d-keepaway) استفاده کنید.



## نحوه‌ی اجرای تیم

برای اجرای تیم بعد از make کردن تیم دو اسکریپت وجود دارد. یکی برای تیم مهاجم  یکی دیگر برای تیم مدافع.

اجرا کردن هر کدام از این اسکریپت‌ها به شکل زیر است.

```bash
./keepaway-keeper.sh
./keepaway-taker.sh
```

برای اجرای تیم به صورت دیباگ مود و اجرا شدن dlog ها میتوانید اسکریپت‌های زیر را ران کنید.

```bash
./keepaway-keeper-debug.sh
./keepaway-taker-debug.sh
```

## تغییر کد

برای تغییر بازی تیم‌پایه در موقعیت دفاعی و تهاجمی میتوانید فایل‌های زیر را تغییر دهید

```c++
class RoleKeepawayKeeper; // file role_keepaway_keeper.cpp or .h
class RoleKeepawayTaker; // file role_keepaway_taker.cpp or .h
```

هر کدام از این کلاس‌ها دارای تابعی به اسم execute هستند که دو تابع do_kick, do_move را با توجه به صاحب‌توپ بودن یا نبودن صدا میکنند.

شما با تغییر این توابع می‌توانید تیم خود را بسازید.



## لینک‌های مرتبط

1. [UT AustinVila Keepaway](https://www.cs.utexas.edu/~AustinVilla/sim/keepaway/)
